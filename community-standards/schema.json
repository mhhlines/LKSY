{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "lksy.org List Schema",
  "type": "object",
  "required": ["id", "version", "name", "description", "type", "tags"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9-]+$",
      "description": "Unique identifier (kebab-case)"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version (MAJOR.MINOR.PATCH)"
    },
    "name": {
      "type": "string",
      "description": "Human-readable name"
    },
    "description": {
      "type": "string",
      "maxLength": 200,
      "description": "Short description (1-2 sentences)"
    },
    "type": {
      "type": "string",
      "enum": ["checks", "values"],
      "description": "Type of list"
    },
    "status": {
      "type": "string",
      "enum": ["active", "proposed", "deprecated"],
      "default": "active"
    },
    "maintainers": {
      "type": "array",
      "items": {"type": "string"},
      "description": "GitHub usernames of maintainers"
    },
    "tags": {
      "type": "array",
      "items": {"type": "string"},
      "minItems": 2,
      "description": "Tags for categorization and SEO"
    },
    "first_published": {
      "type": "string",
      "format": "date"
    },
    "last_updated": {
      "type": "string",
      "format": "date"
    },
    "seo": {
      "type": "object",
      "properties": {
        "title": {"type": "string"},
        "description": {"type": "string"},
        "keywords": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    "checks": {
      "type": "array",
      "description": "For type='checks' lists",
      "items": {
        "type": "object",
        "required": ["id", "name", "severity", "description"],
        "properties": {
          "id": {"type": "string"},
          "name": {"type": "string"},
          "severity": {
            "type": "string",
            "enum": ["critical", "major", "minor", "recommended"]
          },
          "description": {"type": "string"},
          "rationale": {"type": "string"},
          "automatable": {"type": "boolean"},
          "detection_method": {"type": "string"},
          "false_positive_rate": {
            "type": "string",
            "enum": ["very_low", "low", "medium", "high"]
          },
          "votes": {
            "type": "object",
            "properties": {
              "upvotes": {"type": "integer"},
              "downvotes": {"type": "integer"}
            }
          },
          "status": {
            "type": "string",
            "enum": ["approved", "proposed", "deprecated"]
          }
        }
      }
    },
    "values": {
      "type": "object",
      "description": "For type='values' lists (flexible structure)"
    }
  }
}


